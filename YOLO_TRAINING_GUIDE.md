# YOLO Nail Detection Training Guide

This guide will help you train a custom YOLO model for nail detection.

## üìã Prerequisites

1. **Annotated Dataset**: You need hand images with bounding boxes around nails
2. **Annotation Tool**: Use LabelImg, Roboflow, or similar tools
3. **Python Environment**: Ensure ultralytics is installed

## üìÅ Dataset Structure

Create the following directory structure:

```
yolo_nail_dataset/
‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îú‚îÄ‚îÄ images/          # Training images
‚îÇ   ‚îî‚îÄ‚îÄ labels/           # Training annotations (.txt files)
‚îú‚îÄ‚îÄ val/
‚îÇ   ‚îú‚îÄ‚îÄ images/          # Validation images
‚îÇ   ‚îî‚îÄ‚îÄ labels/          # Validation annotations (.txt files)
‚îî‚îÄ‚îÄ dataset.yaml          # Auto-generated by notebook
```

## üè∑Ô∏è Annotation Format (YOLO)

Each image needs a corresponding `.txt` file with the same name.

**Format**: `class_id x_center y_center width height`

- All values are **normalized** (0.0 to 1.0)
- `class_id`: Always `0` for nail (single class)
- Coordinates are relative to image dimensions

**Example** (`hand_image.jpg` ‚Üí `hand_image.txt`):
```
0 0.45 0.35 0.08 0.12
0 0.65 0.35 0.08 0.12
0 0.55 0.50 0.08 0.12
```
This means 3 nails detected in the image.

## üõ†Ô∏è Annotation Tools

### Option 1: LabelImg (Recommended for beginners)

1. **Install LabelImg**:
   ```bash
   pip install labelImg
   labelImg
   ```

2. **Setup**:
   - Open LabelImg
   - Change save format to "YOLO" (not PascalVOC)
   - Create a class: "nail" (class_id = 0)

3. **Annotate**:
   - Open image directory: `yolo_nail_dataset/train/images/`
   - Draw bounding boxes around each nail
   - Save annotations (auto-saves to `labels/` folder)

### Option 2: Roboflow (Cloud-based)

1. Go to https://roboflow.com/
2. Create a new project
3. Upload images and annotate online
4. Export in YOLO format

### Option 3: CVAT (Advanced)

- Professional annotation tool
- Supports team collaboration
- https://cvat.org/

## üìä Dataset Requirements

**Minimum Recommended**:
- Training: 100+ images
- Validation: 20+ images
- More data = better model performance

**Image Quality**:
- Clear, visible nails
- Various lighting conditions
- Different hand positions
- Multiple nails per image (if possible)

## üöÄ Training Steps

1. **Prepare your dataset** following the structure above
2. **Open the notebook**: `train_yolo_nail_detector.ipynb`
3. **Update configuration**:
   - Set `DATASET_DIR` to your dataset path
   - Adjust `EPOCHS`, `BATCH_SIZE`, `MODEL_SIZE` as needed
4. **Run all cells** in order
5. **Wait for training** to complete (can take hours depending on data/hardware)
6. **Model will be saved** to `models/yolo_nail_detector_best.pt`

## ‚öôÔ∏è Configuration Options

### Model Sizes:
- `n` (nano): Fastest, smallest, least accurate
- `s` (small): Good balance
- `m` (medium): Better accuracy, slower
- `l` (large): High accuracy, slower
- `x` (xlarge): Best accuracy, slowest

### Training Parameters:
- `EPOCHS`: Number of training iterations (100-300 recommended)
- `BATCH_SIZE`: Images per batch (adjust based on GPU memory)
- `IMG_SIZE`: Input image size (640 is standard)

## üìà Expected Results

After training, you should see:
- **mAP50**: Mean Average Precision at IoU 0.5 (target: >0.7)
- **mAP50-95**: Mean Average Precision at IoU 0.5-0.95 (target: >0.5)
- **Precision**: How accurate detections are
- **Recall**: How many nails are detected

## üîß Using the Trained Model

After training, update `app.py`:

```python
# In app.py, line 60, change:
nail_detector = NailDetector()

# To:
nail_detector = NailDetector(model_path='models/yolo_nail_detector_best.pt')
```

## üêõ Troubleshooting

### "No module named 'ultralytics'"
```bash
pip install ultralytics
```

### "CUDA out of memory"
- Reduce `BATCH_SIZE` (try 8, 4, or 2)
- Use smaller model (`MODEL_SIZE = 'n'`)

### "Dataset directory not found"
- Check `DATASET_DIR` path in notebook
- Ensure directory structure matches guide

### Low accuracy after training
- Add more training images
- Check annotation quality
- Increase training epochs
- Try larger model size

## üìö Additional Resources

- YOLOv8 Documentation: https://docs.ultralytics.com/
- LabelImg Tutorial: https://github.com/HumanSignal/labelImg
- Roboflow: https://roboflow.com/learn

